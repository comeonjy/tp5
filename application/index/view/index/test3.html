<!DOCTYPE html>
<html>
<head>
	<title></title>
	<script charset="utf-8" src="http://map.qq.com/api/js?v=2.exp"></script>
	<script type="text/javascript" src="https://3gimg.qq.com/lightmap/components/geolocation/geolocation.min.js"></script>
	<style type="text/css">
	#container{
		width:100%;
		height:500px;
	}
	</style>
</head>
<body onload="">
<div id="pos-area">
        <p id="demo">点击下面的按钮，获得对应信息：<br /></p>
</div>
<div id="container"></div>
 <script type="text/JavaScript">
 		window.onload=function(){
 			geolocation.getLocation(showPosition, showErr, options);
 		}
 		//初始化
        var geolocation = new qq.maps.Geolocation("DHOBZ-N7AKS-O2XOY-6W5TK-AZT37-P4BL6", "myapp");
        var options = {timeout: 8000};

        function showPosition(position) {
        	document.getElementById("demo").innerHTML="您在"+position.province+position.city+position.addr;
            init(position.lat,position.lng);
        };

        function init(lat,lng) {
	        //定义map变量 调用 qq.maps.Map() 构造函数   获取地图显示容器
	        //实例化一个位置对象
	        var center=new qq.maps.LatLng(lat,lng);
	        //画地图
	        var map = new qq.maps.Map(document.getElementById("container"), {
	            center: center,      // 地图的中心地理坐标。
	            zoom:18                                                // 地图的中心地理坐标。
	        });
	        //设置标记
		    var marker = new qq.maps.Marker({
		        position: center,
		        animation:qq.maps.MarkerAnimation.DROP,
		        map: map
		    });
		    //监听标记点击事件
		    qq.maps.event.addListener(marker,"click",function(){
		        alert("you clicked me")
		    });

    	}

         function showErr() {
            document.getElementById("demo").appendChild(document.createElement('p')).innerHTML = "定位失败！";
            document.getElementById("pos-area").scrollTop = document.getElementById("pos-area").scrollHeight;
        };

        </script>
</body>
</html>